{"ast":null,"code":"var _jsxFileName = \"/Users/colepatton/vibin/src/components/Post.js\";\nimport React, { Component } from 'react';\nimport profilePicturePlaceholder from '../img/profilePicturePlaceholder.jpg';\nimport '../style/App.css';\nimport queryString from 'query-string';\nimport { getTrack, playAt, pause } from '../spotifyCalls';\nimport { useHistory } from 'react-router-dom';\n\nclass PostInfo extends Component {\n  render() {\n    let name = this.props.name;\n    let text = this.props.text;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"postInfo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 13,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      className: \"profilePic\",\n      src: profilePicturePlaceholder,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 14,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 15,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"username\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 16,\n        columnNumber: 21\n      }\n    }, name), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"postText\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 17,\n        columnNumber: 21\n      }\n    }, text)));\n  }\n\n}\n\nclass PostMusic extends Component {\n  constructor(props) {\n    super(props);\n\n    this.routeToSpotify = () => {\n      const history = useHistory();\n      history.push('https://open.spotify.com/track/' + this.props.songId);\n    };\n\n    this.loadTrack = async () => {\n      console.log('loading ' + this.props.songName);\n      let parsed = queryString.parse(window.location.search);\n      let accessToken = parsed.access_token;\n      const trackData = await getTrack(accessToken, this.props.songId);\n      const albumCover = trackData.album.images[0].url;\n      this.setState({\n        picLoaded: true,\n        albumUrl: albumCover,\n        songName: this.props.songName\n      });\n    };\n\n    this.state = {\n      picLoaded: false,\n      albumUrl: '',\n      songName: ''\n    };\n    this.routeToSpotify = this.routeToSpotify.bind(this);\n  }\n\n  render() {\n    let songName = this.props.songName;\n    let songArtist = this.props.songArtist;\n\n    if (this.state.songName != this.props.songName) {\n      this.loadTrack();\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"postMusic\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Link, {\n      className: \"albumImg\",\n      to: 'https://open.spotify.com/track/' + this.props.songId,\n      src: this.state.picLoaded ? this.state.albumUrl : profilePicturePlaceholder,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"songCredit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"songName\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 21\n      }\n    }, songName), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"artists\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 21\n      }\n    }, songArtist)));\n  }\n\n}\n\nexport default class Post extends Component {\n  constructor(props) {\n    super(props);\n\n    this.pauseSong = async startTime => {\n      pause(this.props.accessToken);\n      this.stopTimer(startTime);\n    };\n\n    this.playSong = async (songId, startTime, endTime) => {\n      playAt(this.props.deviceId, this.props.accessToken, songId, startTime);\n      clearInterval(this.timer);\n      this.timer = '';\n      this.startTimer(startTime, endTime);\n    };\n\n    this.startTimer = async (startTime, endTime) => {\n      this.setState({\n        time: startTime,\n        start: Date.now() - startTime\n      });\n\n      if (!this.timer) {\n        this.timer = setInterval(() => {\n          this.setState({\n            time: Math.floor(Date.now() - this.state.start)\n          });\n\n          if (this.state.time > endTime) {\n            this.pauseSong(startTime);\n          }\n        }, 1000);\n      }\n    };\n\n    this.stopTimer = async startTime => {\n      console.log('Stop timer');\n      this.setState({\n        time: startTime\n      });\n      clearInterval(this.timer);\n      this.timer = '';\n    };\n\n    this.handleMouseHover = this.handleMouseHover.bind(this);\n    this.handleMouseLeave = this.handleMouseLeave.bind(this);\n    this.state = {\n      playing: false,\n      time: 0,\n      start: 0\n    };\n  }\n\n  handleMouseHover() {\n    this.playSong(this.props.post.songId, this.props.post.startTime, this.props.post.stopTime);\n  }\n\n  handleMouseLeave() {\n    setTimeout(() => {\n      this.pauseSong(this.props.post.startTime);\n    }, 300);\n  }\n\n  render() {\n    let post = this.props.post;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"post\",\n      onMouseEnter: this.handleMouseHover,\n      onMouseLeave: this.handleMouseLeave,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(PostInfo, {\n      name: post.name,\n      text: post.text,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(PostMusic, {\n      songName: post.songName,\n      songArtist: post.songArtist,\n      songId: post.songId,\n      href: \"https://open.spotify.com/track/6ZzYETKetIfNUsZUb23jgG\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/colepatton/vibin/src/components/Post.js"],"names":["React","Component","profilePicturePlaceholder","queryString","getTrack","playAt","pause","useHistory","PostInfo","render","name","props","text","PostMusic","constructor","routeToSpotify","history","push","songId","loadTrack","console","log","songName","parsed","parse","window","location","search","accessToken","access_token","trackData","albumCover","album","images","url","setState","picLoaded","albumUrl","state","bind","songArtist","Post","pauseSong","startTime","stopTimer","playSong","endTime","deviceId","clearInterval","timer","startTimer","time","start","Date","now","setInterval","Math","floor","handleMouseHover","handleMouseLeave","playing","post","stopTime","setTimeout"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport profilePicturePlaceholder from '../img/profilePicturePlaceholder.jpg';\nimport '../style/App.css';\nimport queryString from 'query-string';\nimport { getTrack, playAt, pause } from '../spotifyCalls';\nimport { useHistory } from 'react-router-dom';\n\nclass PostInfo extends Component {\n    render() {\n        let name = this.props.name;\n        let text = this.props.text;\n        return (\n            <div className=\"postInfo\">\n                <img className=\"profilePic\" src={profilePicturePlaceholder}></img>\n                <div>\n                    <h3 className=\"username\">{name}</h3>\n                    <p className=\"postText\">{text}</p>\n                </div>\n            </div>\n        );\n    }\n}\n\nclass PostMusic extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            picLoaded: false,\n            albumUrl: '',\n            songName: ''\n        };\n        this.routeToSpotify = this.routeToSpotify.bind(this);\n    }\n    routeToSpotify = () => {\n        const history = useHistory();\n        history.push('https://open.spotify.com/track/' + this.props.songId);\n    }\n    loadTrack = async () => {\n        console.log('loading ' + this.props.songName);\n        let parsed = queryString.parse(window.location.search);\n        let accessToken = parsed.access_token;\n        const trackData = await getTrack(accessToken, this.props.songId);\n        const albumCover = trackData.album.images[0].url;\n        this.setState({\n            picLoaded: true,\n            albumUrl: albumCover,\n            songName: this.props.songName\n        });\n    }\n    render() {\n        let songName = this.props.songName;\n        let songArtist = this.props.songArtist;\n        if (this.state.songName != this.props.songName) {\n            this.loadTrack();\n        }\n        return (\n            <div className=\"postMusic\">\n                <Link className=\"albumImg\" to={'https://open.spotify.com/track/' + this.props.songId} src={this.state.picLoaded ? this.state.albumUrl : profilePicturePlaceholder}></Link>\n                <div className=\"songCredit\">\n                    <h4 className=\"songName\">{songName}</h4>\n                    <p className=\"artists\">{songArtist}</p>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default class Post extends Component {\n    constructor(props) {\n        super(props);\n        this.handleMouseHover = this.handleMouseHover.bind(this);\n        this.handleMouseLeave = this.handleMouseLeave.bind(this);\n        this.state = {\n            playing: false,\n            time: 0,\n            start: 0\n        };\n    }\n    pauseSong = async (startTime) => {\n        pause(this.props.accessToken)\n        this.stopTimer(startTime);\n    }\n    playSong = async (songId, startTime, endTime) => {\n        playAt(this.props.deviceId, this.props.accessToken, songId, startTime);\n        clearInterval(this.timer);\n        this.timer = '';\n        this.startTimer(startTime, endTime);\n    }\n    startTimer = async (startTime, endTime) => {\n        this.setState({\n            time: startTime,\n            start: Date.now() - startTime\n        });\n        if (!this.timer) {\n            this.timer = setInterval(() => {\n                this.setState({\n                    time: Math.floor(Date.now() - this.state.start),\n                });\n                if (this.state.time > endTime) {\n                    this.pauseSong(startTime);\n                }\n            }, 1000);\n        }\n    }\n    stopTimer = async (startTime) => {\n        console.log('Stop timer');\n        this.setState({\n            time: startTime,\n        });\n        clearInterval(this.timer);\n        this.timer = '';\n    }\n    handleMouseHover() {\n        this.playSong(this.props.post.songId, this.props.post.startTime, this.props.post.stopTime);\n    }\n    handleMouseLeave() {\n        setTimeout((() => {\n            this.pauseSong(this.props.post.startTime);\n        }), 300);\n    }\n    render() {\n        let post = this.props.post;\n\n        return (\n            <div className=\"post\" onMouseEnter={this.handleMouseHover} onMouseLeave={this.handleMouseLeave}>\n                <PostInfo name={post.name} text={post.text} />\n                <PostMusic songName={post.songName} songArtist={post.songArtist} songId={post.songId} href=\"https://open.spotify.com/track/6ZzYETKetIfNUsZUb23jgG\"/>\n            </div>\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}