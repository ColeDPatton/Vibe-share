{"ast":null,"code":"var _jsxFileName = \"/Users/colepatton/vibin/src/components/NewPost.js\";\nimport React, { Component } from 'react';\nimport profilePicturePlaceholder from '../img/profilePicturePlaceholder.jpg';\nimport '../style/App.css';\nimport queryString from 'query-string';\nimport { getTrack, playAt, pause, search } from '../spotifyCalls';\nimport { withStyles, makeStyles, duration } from '@material-ui/core/styles';\nimport Slider from '@material-ui/core/Slider';\nexport default class NewPost extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updateResults = async filterString => {\n      const results = await search(this.props.accessToken, filterString);\n      this.setState({\n        searching: false,\n        searchResults: results.tracks.items\n      });\n    };\n\n    this.switchForm = () => {\n      const nextPage = this.state.formPage === 1 ? 2 : 1;\n      this.setState({\n        defaultTime: [this.state.startTime, this.state.endTime],\n        formPage: nextPage\n      });\n    };\n\n    this.pauseSong = async accessToken => {\n      await pause(accessToken);\n      this.stopTimer(); // console.log(\"pause\");\n    };\n\n    this.playSong = async (deviceId, accessToken, songId) => {\n      await playAt(deviceId, accessToken, songId, this.state.startTime);\n      this.stopTimer();\n      this.startTimer();\n    };\n\n    this.handleSliderChange = (event, value) => {\n      this.setState({\n        startTime: value[0] * 1000,\n        endTime: value[1] * 1000,\n        time: this.state.playing ? this.state.time : value[0] * 1000\n      });\n    };\n\n    this.state = {\n      text: '',\n      startTime: 23000,\n      endTime: 64000,\n      defaultTime: [23000, 64000],\n      time: 23000,\n      start: 0,\n      playing: false,\n      searching: false,\n      filterString: '',\n      searchResults: [],\n      formPage: 1,\n      selectedSong: {},\n      song: ''\n    };\n    this.selectSong = this.selectSong.bind(this);\n    this.handleSliderChange = this.handleSliderChange.bind(this);\n    this.startTimer = this.startTimer.bind(this);\n    this.stopTimer = this.stopTimer.bind(this);\n    this.handlePlayClick = this.handlePlayClick.bind(this);\n    this.handlePauseClick = this.handlePauseClick.bind(this);\n  }\n\n  selectSong(song) {\n    console.log(song);\n    this.setState({\n      searching: false,\n      searchResults: [],\n      filterString: \"\",\n      selectedSong: {\n        name: song.name,\n        artist: song.album.artists[0].name,\n        art: song.album.images[0].url,\n        id: song.id,\n        duration: song.duration_ms,\n        preview_url: song.preview_url\n      }\n    });\n  }\n\n  startTimer() {\n    this.setState({\n      playing: true,\n      time: this.state.startTime,\n      start: Date.now() - this.state.time\n    });\n\n    if (!this.timer) {\n      this.timer = setInterval(() => {\n        this.setState({\n          time: Math.floor(Date.now() - this.state.start)\n        });\n\n        if (this.state.time > this.state.endTime) {\n          this.pauseSong(this.props.accessToken);\n        }\n      }, 1000);\n    }\n  }\n\n  stopTimer() {\n    this.setState({\n      playing: false,\n      time: this.state.startTime\n    });\n    clearInterval(this.timer);\n    this.timer = '';\n  }\n\n  formatTime() {\n    let time = Math.floor(this.state.time / 1000);\n    let minutes = Math.floor(time / 60);\n    let seconds = time - minutes * 60;\n    return minutes + (seconds <= 9 ? \":0\" : \":\") + seconds;\n  }\n\n  submitPost() {\n    this.props.submitNewPost(this.state.text, this.state.selectedSong.id, this.state.selectedSong.name, this.state.selectedSong.artist, this.state.startTime, this.state.endTime);\n  }\n\n  handlePlayClick() {\n    if (this.state.product === 'premium') {\n      this.playSong(this.props.deviceId, this.props.accessToken, this.state.selectedSong.id);\n    } else {\n      let song = new Audio(this.state.selectedSong.preview_url);\n      this.setState({\n        song: song\n      });\n      song.play();\n    }\n  }\n\n  handlePauseClick() {\n    if (this.state.product === 'premium') {\n      this.pauseSong(this.props.accessToken);\n    } else {\n      this.state.song.pause();\n    }\n  }\n\n  render() {\n    if (this.state.filterString === \"\" && this.state.searching) {\n      this.setState({\n        searching: false,\n        searchResults: []\n      });\n    } else if (this.state.searching) {\n      this.updateResults(this.state.filterString);\n    }\n\n    if (this.props.userName === 'Not logged in') {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPost\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPostTop\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        className: \"username\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 25\n        }\n      }, this.props.userName), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"cancelX\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"logInMessage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 21\n        }\n      }, \"Log in to create and share posts\"), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPostNotLoggedIn\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"myButtonBlue\",\n        onClick: this.props.handleLogInButton,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 25\n        }\n      }, \"Log In\")));\n    } else if (this.state.formPage === 1) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPost\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPostTop\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        className: \"username\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 25\n        }\n      }, this.props.userName), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"cancelX\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 29\n        }\n      }))), this.state.text ? /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"newPostText\",\n        type: \"text\",\n        defaultValue: this.state.text,\n        onInput: txt => {\n          this.setState({\n            text: txt.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 29\n        }\n      }) : /*#__PURE__*/React.createElement(\"textarea\", {\n        className: \"newPostText\",\n        type: \"text\",\n        placeholder: \"Share your feelings with the world...\",\n        onInput: txt => {\n          console.log(txt);\n          this.setState({\n            text: txt.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPostBottom\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"myButtonBlue\",\n        onClick: () => {\n          this.switchForm();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 25\n        }\n      }, \"Add Song\")));\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPost\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPostTop\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        className: \"username\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 25\n        }\n      }, this.props.userName), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"cancelX\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line1\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 29\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"line2\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 29\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"searchBar\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 25\n        }\n      }, \"Search for a song: \"), /*#__PURE__*/React.createElement(Filter, {\n        onTextChange: text => {\n          this.setState({\n            searching: true,\n            filterString: text\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 25\n        }\n      })), this.state.searchResults.length > 0 ? this.state.searchResults.map(currentSong => /*#__PURE__*/React.createElement(\"div\", {\n        className: \"searchResult\",\n        onClick: () => this.selectSong(currentSong),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"searchResultImg\",\n        src: currentSong.album.images[0].url,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 37\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 37\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"searchResultSong\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 41\n        }\n      }, currentSong.name), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"searchResultArtist\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 41\n        }\n      }, currentSong.album.artists[0].name)))) : this.state.selectedSong.name && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"selectedSong\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"searchResultImg\",\n        src: this.state.selectedSong.art,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 33\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"searchResultSong\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 37\n        }\n      }, this.state.selectedSong.name), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"searchResultArtist\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 37\n        }\n      }, this.state.selectedSong.artist)), this.props.product && this.props.product === 'premium' ? /*#__PURE__*/React.createElement(SongTimeSlider, {\n        max: Math.ceil(this.state.selectedSong.duration / 1000),\n        defaultValue: [this.state.defaultTime[0] / 1000, this.state.defaultTime[1] / 1000],\n        valueLabelDisplay: \"auto\",\n        \"aria-labelledby\": \"range-slider\",\n        valueLabelFormat: (value, index) => {\n          let minutes = Math.floor(value / 60);\n          let seconds = value - minutes * 60;\n          return minutes + (seconds <= 9 ? \":0\" : \":\") + seconds;\n        },\n        onChange: this.handleSliderChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 37\n        }\n      }) : /*#__PURE__*/React.createElement(SongTimeSlider, {\n        max: Math.ceil(this.state.selectedSong.duration / 1000),\n        defaultValue: [this.state.defaultTime[0] / 1000, this.state.defaultTime[1] / 1000],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 37\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"songTimeControls\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"myButtonBlue\",\n        onClick: () => {\n          this.playSong(this.props.deviceId, this.props.accessToken, this.state.selectedSong.id);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 37\n        }\n      }, \"Play Clip\"), /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"songTime\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 37\n        }\n      }, this.formatTime()), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"myButtonBlue\",\n        onClick: () => {\n          this.pauseSong(this.props.accessToken);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 37\n        }\n      }, \"Pause\"))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"newPostBottom\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"myButtonBlue\",\n        onClick: () => {\n          this.switchForm();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 25\n        }\n      }, \"Go back\"), /*#__PURE__*/React.createElement(\"button\", {\n        className: \"myButtonBlue\",\n        onClick: () => {\n          this.submitPost();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 25\n        }\n      }, \"Post\")));\n    }\n  }\n\n}\nconst SongTimeSlider = withStyles({\n  root: {\n    color: '#363d6b',\n    height: 3,\n    padding: '13px 0',\n    width: '80%',\n    'margin-top': '1.67em'\n  },\n  thumb: {\n    height: 27,\n    width: 27,\n    backgroundColor: '#fff',\n    border: '1px solid currentColor',\n    marginTop: -12,\n    marginLeft: -13,\n    boxShadow: '#ebebeb 0 2px 2px',\n    '&:focus, &:hover, &$active': {\n      boxShadow: '#ccc 0 2px 3px 1px'\n    },\n    '& .bar': {\n      // display: inline-block !important;\n      height: 9,\n      width: 1,\n      backgroundColor: 'currentColor',\n      marginLeft: 1,\n      marginRight: 1\n    }\n  },\n  active: {},\n  track: {\n    height: 5,\n    top: '40%'\n  },\n  rail: {\n    color: '#d8d8d8',\n    opacity: 1,\n    height: 3\n  }\n})(Slider);\n\nclass Filter extends Component {\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"filter\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      onKeyUp: event => this.props.onTextChange(event.target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}","map":{"version":3,"sources":["/Users/colepatton/vibin/src/components/NewPost.js"],"names":["React","Component","profilePicturePlaceholder","queryString","getTrack","playAt","pause","search","withStyles","makeStyles","duration","Slider","NewPost","constructor","props","updateResults","filterString","results","accessToken","setState","searching","searchResults","tracks","items","switchForm","nextPage","state","formPage","defaultTime","startTime","endTime","pauseSong","stopTimer","playSong","deviceId","songId","startTimer","handleSliderChange","event","value","time","playing","text","start","selectedSong","song","selectSong","bind","handlePlayClick","handlePauseClick","console","log","name","artist","album","artists","art","images","url","id","duration_ms","preview_url","Date","now","timer","setInterval","Math","floor","clearInterval","formatTime","minutes","seconds","submitPost","submitNewPost","product","Audio","play","render","userName","handleLogInButton","txt","target","length","map","currentSong","ceil","index","SongTimeSlider","root","color","height","padding","width","thumb","backgroundColor","border","marginTop","marginLeft","boxShadow","marginRight","active","track","top","rail","opacity","Filter","onTextChange"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport profilePicturePlaceholder from '../img/profilePicturePlaceholder.jpg';\nimport '../style/App.css';\nimport queryString from 'query-string';\nimport { getTrack, playAt, pause, search } from '../spotifyCalls';\nimport { withStyles, makeStyles, duration } from '@material-ui/core/styles';\nimport Slider from '@material-ui/core/Slider';\n\nexport default class NewPost extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            text: '',\n            startTime: 23000,\n            endTime: 64000,\n            defaultTime: [23000, 64000],\n            time: 23000,\n            start: 0,\n            playing: false,\n            searching: false,\n            filterString: '',\n            searchResults: [],\n            formPage: 1,\n            selectedSong: {},\n            song: ''\n        };\n        this.selectSong = this.selectSong.bind(this);\n        this.handleSliderChange = this.handleSliderChange.bind(this);\n        this.startTimer = this.startTimer.bind(this);\n        this.stopTimer = this.stopTimer.bind(this);\n        this.handlePlayClick = this.handlePlayClick.bind(this);\n        this.handlePauseClick = this.handlePauseClick.bind(this);\n    }\n\n    updateResults = async (filterString) => {\n        const results = await search(this.props.accessToken, filterString);\n        this.setState({ searching: false, searchResults: results.tracks.items });\n    }\n    switchForm = () => {\n        const nextPage = this.state.formPage === 1 ? 2 : 1;\n        this.setState({\n            defaultTime: [this.state.startTime, this.state.endTime],\n            formPage: nextPage\n        });\n    }\n    selectSong(song) {\n        console.log(song);\n        this.setState({\n            searching: false,\n            searchResults: [],\n            filterString: \"\",\n            selectedSong: {\n                name: song.name,\n                artist: song.album.artists[0].name,\n                art: song.album.images[0].url,\n                id: song.id,\n                duration: song.duration_ms,\n                preview_url: song.preview_url\n            }\n        });\n    }\n    pauseSong = async (accessToken) => {\n        await pause(accessToken);\n        this.stopTimer();\n        // console.log(\"pause\");\n    }\n    playSong = async (deviceId, accessToken, songId) => {\n        await playAt(deviceId, accessToken, songId, this.state.startTime);\n        this.stopTimer();\n        this.startTimer();\n    }\n    handleSliderChange = (event, value) => {\n        this.setState({\n            startTime: (value[0] * 1000),\n            endTime: (value[1] * 1000),\n            time: this.state.playing ? this.state.time : (value[0] * 1000)\n        });\n    }\n    startTimer() {\n        this.setState({\n            playing: true,\n            time: this.state.startTime,\n            start: Date.now() - this.state.time\n        });\n        if (!this.timer) {\n            this.timer = setInterval(() => {\n                this.setState({\n                    time: Math.floor(Date.now() - this.state.start)\n                });\n                if (this.state.time > this.state.endTime) {\n                    this.pauseSong(this.props.accessToken);\n                }\n            }, 1000);\n        }\n    }\n    stopTimer() {\n        this.setState({\n            playing: false,\n            time: this.state.startTime\n        });\n        clearInterval(this.timer);\n        this.timer = '';\n    }\n    formatTime() {\n        let time = Math.floor(this.state.time / 1000);\n        let minutes = Math.floor(time / 60);\n        let seconds = time - (minutes * 60);\n        return minutes + (seconds <= 9 ? \":0\" : \":\") + seconds;\n    }\n    submitPost() {\n        this.props.submitNewPost(\n            this.state.text,\n            this.state.selectedSong.id,\n            this.state.selectedSong.name,\n            this.state.selectedSong.artist,\n            this.state.startTime,\n            this.state.endTime);\n    }\n    handlePlayClick() {\n        if (this.state.product === 'premium') {\n            this.playSong(this.props.deviceId, this.props.accessToken, this.state.selectedSong.id);\n        } else {\n            let song = new Audio(this.state.selectedSong.preview_url);\n            this.setState({\n                song: song\n            });\n            song.play();\n        }\n    }\n    handlePauseClick() {\n        if (this.state.product === 'premium') {\n            this.pauseSong(this.props.accessToken);\n        } else {\n            this.state.song.pause();\n        }\n    }\n\n    render() {\n        if (this.state.filterString === \"\" && this.state.searching) {\n            this.setState({ searching: false, searchResults: [] });\n        } else if (this.state.searching) {\n            this.updateResults(this.state.filterString);\n        }\n\n        if (this.props.userName === 'Not logged in') {\n            return (\n                <div className=\"newPost\">\n                    <div className=\"newPostTop\">\n                        <h1 className=\"username\">{this.props.userName}</h1>\n                        <div className=\"cancelX\">\n                            <div className=\"line1\"></div>\n                            <div className=\"line2\"></div>\n                        </div>\n                    </div>\n                    <h3 className='logInMessage'>Log in to create and share posts</h3>\n                    <div className=\"newPostNotLoggedIn\">\n                        <button className='myButtonBlue' onClick={this.props.handleLogInButton}>Log In</button>\n                    </div>\n                </div>\n            );\n        } else if (this.state.formPage === 1) {\n            return (\n                <div className=\"newPost\">\n                    <div className=\"newPostTop\">\n                        <h1 className=\"username\">{this.props.userName}</h1>\n                        <div className=\"cancelX\">\n                            <div className=\"line1\"></div>\n                            <div className=\"line2\"></div>\n                        </div>\n                    </div>\n                    {\n                        this.state.text ?\n                            <textarea className=\"newPostText\" type=\"text\" defaultValue={this.state.text} onInput={txt => {\n                                this.setState({ text: txt.target.value });\n                            }}></textarea> :\n                            <textarea className=\"newPostText\" type=\"text\" placeholder=\"Share your feelings with the world...\" onInput={txt => {\n                                console.log(txt);\n                                this.setState({ text: txt.target.value });\n                            }}></textarea>\n                    }\n                    <div className=\"newPostBottom\">\n                        <button className='myButtonBlue' onClick={() => {\n                            this.switchForm();\n                        }}>Add Song</button>\n                    </div>\n                </div>\n            );\n        } else {\n            return (\n                <div className=\"newPost\">\n                    <div className=\"newPostTop\">\n                        <h1 className=\"username\">{this.props.userName}</h1>\n                        <div className=\"cancelX\">\n                            <div className=\"line1\"></div>\n                            <div className=\"line2\"></div>\n                        </div>\n                    </div>\n                    <div className=\"searchBar\">\n                        <h4>Search for a song: </h4>\n                        <Filter onTextChange={text => {\n                            this.setState({ searching: true, filterString: text });\n                        }} />\n                    </div>\n                    {\n                        this.state.searchResults.length > 0 ?\n                            this.state.searchResults.map(currentSong =>\n                                <div className=\"searchResult\" onClick={() => this.selectSong(currentSong)}>\n                                    <img className=\"searchResultImg\" src={currentSong.album.images[0].url} />\n                                    <div>\n                                        <h3 className=\"searchResultSong\">{currentSong.name}</h3>\n                                        <h5 className=\"searchResultArtist\">{currentSong.album.artists[0].name}</h5>\n                                    </div>\n                                </div>\n                            ) :\n                            this.state.selectedSong.name &&\n                            <div className=\"selectedSong\">\n                                <img className=\"searchResultImg\" src={this.state.selectedSong.art} />\n                                <div>\n                                    <h3 className=\"searchResultSong\">{this.state.selectedSong.name}</h3>\n                                    <h5 className=\"searchResultArtist\">{this.state.selectedSong.artist}</h5>\n                                </div>\n                                {this.props.product && this.props.product === 'premium' ?\n                                    <SongTimeSlider\n                                        max={Math.ceil(this.state.selectedSong.duration / 1000)}\n                                        defaultValue={[this.state.defaultTime[0] / 1000, this.state.defaultTime[1] / 1000]}\n                                        valueLabelDisplay=\"auto\"\n                                        aria-labelledby=\"range-slider\"\n                                        valueLabelFormat={(value, index) => {\n                                            let minutes = Math.floor(value / 60);\n                                            let seconds = value - (minutes * 60);\n                                            return minutes + (seconds <= 9 ? \":0\" : \":\") + seconds;\n                                        }}\n                                        onChange={this.handleSliderChange}\n                                    /> :\n                                    <SongTimeSlider\n                                        max={Math.ceil(this.state.selectedSong.duration / 1000)}\n                                        defaultValue={[this.state.defaultTime[0] / 1000, this.state.defaultTime[1] / 1000]}\n                                    />\n                                }\n                                <div className='songTimeControls'>\n                                    <button className='myButtonBlue' onClick={() => {\n                                        this.playSong(this.props.deviceId, this.props.accessToken, this.state.selectedSong.id);\n                                    }}>Play Clip</button>\n                                    <h5 className=\"songTime\">{this.formatTime()}</h5>\n                                    <button className='myButtonBlue' onClick={() => {\n                                        this.pauseSong(this.props.accessToken);\n                                    }}>Pause</button>\n                                </div>\n                            </div>\n                    }\n                    <div className=\"newPostBottom\">\n                        <button className='myButtonBlue' onClick={() => {\n                            this.switchForm();\n                        }}>Go back</button>\n                        <button className='myButtonBlue' onClick={() => {\n                            this.submitPost();\n                        }}>Post</button>\n                    </div>\n                </div>\n            );\n        }\n    }\n}\n\nconst SongTimeSlider = withStyles({\n    root: {\n        color: '#363d6b',\n        height: 3,\n        padding: '13px 0',\n        width: '80%',\n        'margin-top': '1.67em'\n    },\n    thumb: {\n        height: 27,\n        width: 27,\n        backgroundColor: '#fff',\n        border: '1px solid currentColor',\n        marginTop: -12,\n        marginLeft: -13,\n        boxShadow: '#ebebeb 0 2px 2px',\n        '&:focus, &:hover, &$active': {\n            boxShadow: '#ccc 0 2px 3px 1px',\n        },\n        '& .bar': {\n            // display: inline-block !important;\n            height: 9,\n            width: 1,\n            backgroundColor: 'currentColor',\n            marginLeft: 1,\n            marginRight: 1,\n        },\n    },\n    active: {},\n    track: {\n        height: 5,\n        top: '40%'\n    },\n    rail: {\n        color: '#d8d8d8',\n        opacity: 1,\n        height: 3,\n    },\n})(Slider);\n\n\nclass Filter extends Component {\n    render() {\n        return (\n            <div className=\"filter\">\n                <input type=\"text\" onKeyUp={event => this.props.onTextChange(event.target.value)} />\n            </div>\n        );\n    }\n}"]},"metadata":{},"sourceType":"module"}